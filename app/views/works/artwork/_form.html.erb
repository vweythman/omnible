<%= clean_form_for(@art) do |f| %>

	<%= error_block(@art) %>

	<fieldset class="primary-fieldset">
		<%= f.string_cell :title, "Title" %>
		<%= f.text_cell   :summary, class: :minor, placeholder: "Description" %>

		<%= f.fields_for :picture do |pic| %>
			<% picture = pic.object.decorate %>
			<%= grid_panel do %>
				<%= panel_cell "golden-minor" do %>
					<%= picture.preview_area %>
				<% end %>

				<%= panel_cell "golden-major" do %>
					<%= pic.file_cell :artwork, "Upload" %>
				<% end %>
			<% end %>
		<% end %>
	</fieldset>

	<%= render @art.meta_fields, f: f %>
	<%= render @art.tag_fields,  f: f %>
	
	<%= f.submit_cell %>
<% end %>

<script>
function read_url(input) {

    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
            $('#image-preview').attr('src', e.target.result);
        }

        reader.readAsDataURL(input.files[0]);
    }
}

$("#art_picture_attributes_artwork").change(function(){ read_url(this); });
</script>
